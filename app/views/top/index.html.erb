<!-- ボタンのリンク先 rubyとjsで分ける -->
<% if @current_user then link = '/add' else link = './' end %>

<!-- ワード追加のボタン -->
<div class='text-center mb-4'>
	<a href='<%= link %>' id='get_word' class='btn btn-warning text-center'>新しいワードを追加 ＋</a>
</div>

<table class='table table-sm'>
	<thead class='thead-light'>
		<tr class='row'>
			<th class='col-2 col-lg-1'></th>
			<th class='col-8 col-lg-9'>
				<!-- TwitterやYoutubeのリンクをsessionの値によって場合分け -->

				<!-- 今のセッション -->
				<%= session[:site] + 'で検索　' %>
	
				<!-- パラメータにはサイト名を指定（params[:site]/change_go） -->

				<a href='Google/change_go'
				<% if session[:site] != 'Google' %>  
					<%= 'class=mute' %> 
				<% end %>
				>
					<img src='/google.png' width='20px' class='rounded-circle'>
				</a>			

				<a href='Youtube/change_go'
				<% if session[:site] != 'Youtube' %>  
					<%= 'class=mute' %> 
				<% end %>
				>
					<img src='/youtube.png' width='20px' class=''>
				</a>

				<a href='Twitter/change_go'
				<% if session[:site] != 'Twitter' %>  
					<%= 'class=mute' %> 
				<% end %>
				>
					<img src='/twitter.png' width='20px' class=''>
				</a>

			</th>
			<th class='col-1 col-lg-1'><span class='d-none d-md-block'>目印</span></th>
			<th class='col-1 col-lg-1'><span class='d-none d-md-block'>削除</span></th>
		</tr>
	</thead>
  <tbody id='tb'>
	


	<% if @current_user %><!-- ログイン中は、Rubyでテーブル表示 -->
		<% for word in @words %> <!-- DBから取り出す  -->
			<% user = User.find_by(id: word.user_id) %> <!-- それぞれの単語ごとにユーザーを特定 -->
			<tr class='row'>

				<!-- New -->
				<% if word.visit==0 then deco='NEW' else deco='' end %> <!-- 訪問チェック -->
				<td class='col-2 col-lg-1'>
          <div class='new'><%= deco %></div>
				</td>


				<!-- 検索ワード -->
				<% 
					if session[:site] == 'Google'
						site_url = 'https://www.google.com/search?q='

					elsif session[:site] == 'Youtube'
						site_url = 'https://www.youtube.com/results?search_query='

					elsif session[:site] == 'Twitter'
						site_url = 'https://twitter.com/search?q='
						# https://twitter.com/search?q=単語&src=typd  &src=typd って何？ある方が良いかを検証
					end 
				%>
				<td class='col-8 col-lg-9 word'>
          <a href='<%= "/#{word.id}/visit" %>' onclick='window.open("<%= site_url + word.content %>")' class='d-block'> <!-- visitアクション起こすと同時に、jsでGoogleブラウザ開く -->
	        	<%= word.content %> 
	        	<!-- <%= user.id %>  その単語のユーザーID--> 
        	</a>
				</td>

			  <!-- スター -->  
				<% if word.star==0 then color='nostar' else color='star' end %> <!-- 色の為のクラス -->
				<td class='col-1 col-lg-1'>
          <a href='<%= "/#{word.id}/update" %>' class='<%= color %>'><i class='material-icons'>star</i></a>
				</td>

			  <!-- ごみ箱 -->  
				<td class='col-1 col-lg-1'>
          <a href='<%= "/#{word.id}/delete" %>'><i class='material-icons trash'>delete</i></a>
				</td>

			</tr>
		<% end %> <!-- for文終わり -->



	<% else %> <!-- ログアウト中は、javascriptの関数を読み込む -->

		<script>
			var word = '<%= add() %>' // top_controllerから、生成されたワードを呼び出す
			// 新ワード追加ボタンでonclick起こす前に（ページ読み込み時に）もう単語出来上がらせる
		</script>
		<!-- jQuery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
		<!-- application.jsを読み込む（/app/assets/javascript/application.js） -->
		<%= javascript_include_tag 'storage' %>
		
	<% end %>



  </tbody>
</table>




